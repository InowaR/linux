Урок 6. Запуск стека для веб-приложения

Задание


• Установить Nginx и настроить его на работу с PHP-FPM.

	php-fpm на лекции!

	sudo apt install nginx -y
	sudo nano /etc/nginx/sites-enabled/default
	sudo nginx -t
	cd /var/www/html/ - стартовая страница nginx, apache2

• Установить Apache. Настроить обработку PHP. Добиться одновременной работы с Nginx.

	sudo apt install apache2 -y
	cd /etc/apache2/
	заменить 80 на 8080
	sudo nano ports.conf
	заменить 80 на 8080
	sudo nano sites-enabled/000-default.conf
	sudo apache2 - t

• Настроить схему обратного прокси для Nginx (динамика - на Apache).

	sudo nano /etc/nginx/sites-enabled/default
	
	добавить:
	
		location / {
			proxy_pass http://localhost:8080;  #на порт apache2 
			proxy_set_header Host $host;
			proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
			proxy_set_header X-Real-IP $remote_addr;
		}

		location ~* ^.+.(jpg|jpeg|gif|png|ico|css|zip|pdf|txt|tar|js)$ {
			root /var/www/html;
		}


		cd /var/www/html/
		sudo nano info.php
		<?php phpinfo(); ?>
		sudo apt list libapache2-mod-php
		sudo apt list php8*
		sudo apt install php8.3
		страница phpinfo работает
		
		
		
• Установить MySQL. Создать новую базу данных и таблицу в ней.

	sudo apt install mysql-server -y
	sudo mysql
	CREATE DATABASE database1;
	USE database1;
	CREATE TABLE table1 (id INT, name VARCHAR(50));
	INSERT INTO table1 (id, name) VALUES (1, "Sergey"), (2, "Anton"), (55, "Max");
	SELECT * FROM table1;
	запросы

•* Установить пакет phpmyadmin и запустить его веб-интерфейс для управления MySQL.

•* Настроить схему балансировки трафика между 
несколькими серверами Apache на стороне Nginx с помощью модуля ngx_http_upstream_module.

	скопировать команды в virtual hosts для создания нескольких серверов apache на разных портах
	ngx_http_upstream_module инструкция в гугле
